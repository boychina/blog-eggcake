{"ast":null,"code":"import _defineProperty from \"/Users/hq/Documents/work/blog-eggcake/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nvar _jsxFileName = \"/Users/hq/Documents/work/blog-eggcake/components/Common/WordCloud.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useMemo, useState } from \"react\";\nimport { createCanvas } from \"canvas\";\nimport cloud from \"d3-cloud\";\nimport { random, sortBy } from \"lodash\";\nimport Link from \"next/link\";\nimport { SendOutlined } from \"@ant-design/icons\";\nimport { COLORS } from \"@/config/constant\";\nvar layout = cloud().size([330, 300]).canvas(function () {\n  return createCanvas(330, 300);\n}).padding(2).rotate(function () {\n  return ~~(Math.random() * 2) * 90;\n}).fontSize(function (d) {\n  return d.size;\n});\nexport default function WordCloud(_ref) {\n  _s();\n\n  var _this = this;\n\n  var title = _ref.title,\n      tags = _ref.tags;\n  if (!tags || !Object.keys(tags).length) return null;\n\n  var _useState = useState(''),\n      hoveringWord = _useState[0],\n      setHoveringWord = _useState[1];\n\n  var maxSize = 1;\n  Object.values(tags).forEach(function (_ref2) {\n    var value = _ref2.value;\n\n    if (value > maxSize) {\n      maxSize = value;\n    }\n  });\n  var words = useMemo(function () {\n    //构建传入layout的words\n    var result = [];\n    Object.keys(tags).forEach(function (word) {\n      var wordObj = tags[word];\n      result.push(_objectSpread(_objectSpread({}, wordObj), {}, {\n        text: word,\n        size: Math.log(wordObj.value) * 4 / (Math.log(maxSize) - Math.log(1)) * 4 + 20\n      }));\n    });\n    layout.words(result);\n    layout.start();\n    return result;\n  }, []);\n  return __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 5\n    }\n  }, __jsx(\"div\", {\n    className: \"flex items-center\",\n    style: {\n      padding: \"12px 0\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 7\n    }\n  }, __jsx(SendOutlined, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 9\n    }\n  }), __jsx(\"span\", {\n    className: \"ml-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 9\n    }\n  }, title)), __jsx(\"svg\", {\n    width: \"330\",\n    height: \"300\",\n    className: \"mx-auto md:m-0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }\n  }, __jsx(\"g\", {\n    transform: \"translate(160, 150)\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 9\n    }\n  }, sortBy(words, ['value']).map(function (word, index) {\n    return __jsx(Link, {\n      as: \"/tag/\".concat(word.text),\n      href: \"/tag/[tag]\",\n      key: word.text,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 13\n      }\n    }, __jsx(\"text\", {\n      textAnchor: \"middle\",\n      fill: hoveringWord === word.text ? '#1890ff' : COLORS[index % 11],\n      transform: \"translate(\".concat(word.x, \", \").concat(word.y, \")rotate(\").concat(word.rotate, \")\"),\n      style: {\n        fontSize: word.size\n      },\n      onMouseOver: function onMouseOver() {\n        return setHoveringWord(word.text);\n      },\n      onMouseLeave: function onMouseLeave() {\n        return setHoveringWord('');\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 15\n      }\n    }, __jsx(\"a\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 17\n      }\n    }, word.text)));\n  }))));\n}\n\n_s(WordCloud, \"R3aj48jSMouhGMze12SQPijo+i8=\");\n\n_c = WordCloud;\n\nvar _c;\n\n$RefreshReg$(_c, \"WordCloud\");","map":{"version":3,"sources":["/Users/hq/Documents/work/blog-eggcake/components/Common/WordCloud.js"],"names":["useMemo","useState","createCanvas","cloud","random","sortBy","Link","SendOutlined","COLORS","layout","size","canvas","padding","rotate","Math","fontSize","d","WordCloud","title","tags","Object","keys","length","hoveringWord","setHoveringWord","maxSize","values","forEach","value","words","result","word","wordObj","push","text","log","start","map","index","x","y"],"mappings":"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","sourcesContent":["import { useMemo, useState } from \"react\";\nimport { createCanvas } from \"canvas\";\nimport cloud from \"d3-cloud\";\nimport { random, sortBy } from \"lodash\";\nimport Link from \"next/link\";\nimport { SendOutlined } from \"@ant-design/icons\";\nimport { COLORS } from \"@/config/constant\";\n\nconst layout = cloud()\n  .size([330, 300])\n  .canvas(() => createCanvas(330, 300))\n  .padding(2)\n  .rotate(() => ~~(Math.random() * 2) * 90)\n  .fontSize((d) => d.size);\n\nexport default function WordCloud({ title, tags }) {\n  if (!tags || !Object.keys(tags).length) return null;\n\n  const [hoveringWord, setHoveringWord] = useState('');\n\n  let maxSize = 1;\n\n  Object.values(tags).forEach(({ value }) => {\n    if (value > maxSize) {\n      maxSize = value;\n    }\n  });\n\n  const words = useMemo(() => {\n    //构建传入layout的words\n    let result = [];\n    Object.keys(tags).forEach((word) => {\n     const wordObj = tags[word];\n     result.push({\n       ...wordObj,\n       text: word,\n       size:\n         ((Math.log(wordObj.value) * 4) / (Math.log(maxSize) - Math.log(1))) *\n           4 +\n         20,\n     });\n    });\n    layout.words(result);\n    layout.start();\n    return result;\n  }, []);\n\n  return (\n    <div>\n      <div className=\"flex items-center\" style={{ padding: \"12px 0\" }}>\n        <SendOutlined />\n        <span className=\"ml-1\">{title}</span>\n      </div>\n      <svg width=\"330\" height=\"300\" className=\"mx-auto md:m-0\">\n        <g transform=\"translate(160, 150)\">\n          {sortBy(words, ['value']).map((word, index) => (\n            <Link as={`/tag/${word.text}`} href=\"/tag/[tag]\" key={word.text}>\n              <text\n                textAnchor=\"middle\"\n                fill={hoveringWord === word.text ? '#1890ff' : COLORS[index % 11]}\n                transform={`translate(${word.x}, ${word.y})rotate(${word.rotate})`}\n                style={{ fontSize: word.size }}\n                onMouseOver={() => setHoveringWord(word.text)}\n                onMouseLeave={() => setHoveringWord('')}\n              >\n                <a>{word.text}</a>\n              </text>\n            </Link>\n          ))}\n        </g>\n      </svg>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}